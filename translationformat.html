<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dialogue Script ‚Äî Fun & Colorful</title>
  <style>
    :root{
      --ink: #222;
      --accent: #b5bcff;
      --accent-2: #f878b8;
      --accent-3: #ff82cf;
      --bubble: #ffffff;
      --bubble-2: #c8bfff;
      --bubble-3: #d7a6ee;
      --bubble-4: #a6cefc;
      --bubble-5: #95f3f3;
      --bubble-6: #89da96;
      --bubble-7: #f9fab0;
      --bubble-8: #fcc79c;
      --divider: #cdb1d8;
      --shadow: 0 6px 18px rgba(0,0,0,.08);
      --radius: 20px;
      --transition: all .25s ease;
    }
    html,body{margin:0;height:100%;background:white;color:var(--ink);font-family:"Comic Sans MS","Comic Sans","Chalkboard SE",cursive}

    .wrap{max-width:820px;margin:0 auto;padding:72px 20px 120px;position:relative}
    header{position:sticky;top:0;background:white;z-index:3;padding:16px 0 8px;border-bottom:2px solid rgba(0,0,0,.05);display:flex;align-items:center;justify-content:space-between}
    h1{margin:0;font-size:32px;letter-spacing:.5px}

    .home-btn{font-size:28px;text-decoration:none;transition:var(--transition)}
    .home-btn:hover{transform:rotate(20deg) scale(1.2)}

    .meta{margin:20px 0;padding:20px;border:2px dashed var(--divider);border-radius:16px;box-shadow:var(--shadow);background:white;transition:var(--transition)}
    .meta:hover{transform:translateY(-2px) scale(1.01)}
    .meta h2{margin-top:0;color:#6a00f4}
    .release{font-size:14px;opacity:.8;margin-bottom:12px}

    .characters{margin:12px 0;display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .characters b{flex-basis:100%;font-size:16px;color:#6a00f4}
    .characters img{width:48px;height:48px;border-radius:50%;box-shadow:var(--shadow);transition:var(--transition)}
    .characters img:hover{transform:scale(1.15) rotate(-5deg)}

    .nav-btn{position:fixed;top:50%;transform:translateY(-50%);z-index:10;border:none;background:white;box-shadow:var(--shadow);width:48px;height:48px;border-radius:50%;cursor:pointer;font-size:22px;display:flex;align-items:center;justify-content:center;transition:var(--transition)}
    .nav-btn:hover{background:var(--accent);color:white;transform:translateY(-50%) scale(1.15);}
    .nav-prev{left:12px}
    .nav-next{right:72px}
    .nav-page{right:12px}

    .scene{margin:28px 0}
    .line{display:grid;grid-template-columns:56px 1fr;gap:14px;align-items:flex-start;margin:18px 0;transition:var(--transition)}
    .line.no-avatar{grid-template-columns:56px 1fr;margin-top:-12px}

    .avatar{width:48px;height:48px;border-radius:50%;background:#eee center/cover no-repeat;border:3px solid var(--accent);box-shadow:var(--shadow);transition:var(--transition)}
    .avatar.initials{display:flex;align-items:center;justify-content:center;font-weight:bold}
    .avatar:hover{transform:rotate(-6deg) scale(1.1);border-color:var(--accent-2)}

    .bubble-wrap{display:flex;flex-direction:column;align-items:flex-start}
    .bubble-name{font-weight:bold;margin-bottom:4px;margin-left:6px;color:#4fafe7}

    .bubble{background:var(--bubble);border-radius:var(--radius);padding:14px 18px;box-shadow:var(--shadow);position:relative;transition:var(--transition);max-width:600px}
    .bubble::after{content:"";position:absolute;left:-12px;top:20px;width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;border-right:12px solid var(--bubble)}
    .bubble:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 8px 20px rgba(0,0,0,.12)}

    .line.no-avatar .bubble::after{display:none}

    .divider{display:grid;grid-template-columns:1fr auto 1fr;gap:10px;align-items:center;margin:30px 0}
    .divider .rule{height:2px;background:linear-gradient(90deg, var(--accent), var(--divider), var(--accent-2));border-radius:6px}
    .divider .chip{background:white;border:2px dashed var(--divider);padding:6px 14px;border-radius:999px;box-shadow:var(--shadow);font-weight:bold;transition:var(--transition)}
    .divider .chip:hover{background:var(--accent);color:white}

    figure{margin:20px auto;max-width:90%;text-align:center}
    figure img{max-width:100%;border-radius:12px;box-shadow:var(--shadow);transition:var(--transition)}
    figure img:hover{transform:scale(1.03)}
    figure figcaption{font-size:14px;margin-top:6px;opacity:.8}

    .controls{position:sticky;bottom:0;display:flex;gap:12px;justify-content:center;padding:14px 0;background:white}
    .btn{border:none;background:linear-gradient(135deg, var(--accent), var(--accent-2));color:white;padding:12px 18px;border-radius:16px;cursor:pointer;box-shadow:var(--shadow);font-weight:bold;transition:var(--transition)}
    .btn:hover{filter:brightness(1.1);transform:translateY(-2px) scale(1.03)}
    .btn:active{transform:translateY(1px)}

    .tl-notes{margin-top:60px;padding:20px;border-top:3px dashed var(--divider);font-size:14px;line-height:1.5;position:relative}
    .tl-notes::before{content:"TL NOTES";position:absolute;top:-14px;left:50%;transform:translateX(-50%);background:white;padding:0 12px;color:#6a00f4;font-weight:bold;border:2px dashed var(--divider);border-radius:12px;box-shadow:var(--shadow)}
    .tl-notes h2{display:none}

    .note{position:relative;cursor:help;color:var(--accent);font-weight:bold}
    .note:hover::after{content:attr(data-note);position:absolute;left:0;top:100%;margin-top:6px;background:white;border:1px solid var(--divider);padding:6px 10px;border-radius:8px;box-shadow:var(--shadow);white-space:nowrap;font-size:13px;color:var(--ink)}
  </style>
</head>
<body>
  <header>
    <a class="home-btn" href="https://bleppybee.github.io/" title="Home">üêù</a>
  </header>

  <div class="hex-img-wrap">
    <div class="meta">
      <div class="release">Release Date: <em>2025-08-20</em></div>
      <h2>Story Title: <em>Title of Story</em></h2>
      <div class="characters">
        <b>Characters:</b>
         <img src="images/Heads/ES_Head_Hinata.png" alt="Hinata" >
         <img src="images/Heads/ES_Head_Yuuta.png" alt="Yuuta">
         <img src="images/Heads/ES_Head_Esu.png" alt="Esu">
      </div>
    </div>

    <section id="script"
      data-avatars='{"Yuuta":"images/Icons/Yuuta1.png","Hinata":"images/Icons/Hina1.png","Esu":"images/Icons/Esu1.png"}'>
      <p>:: ‚åÇ Spring ‚Ä¢ Tokyo ::</p>
      <p><b>Yuuta:</b> First day of spring! I brought mochi for everyone.</p>
      <p>And it‚Äôs strawberry flavored!</p>
      <p><b>Hinata:</b> I brought‚Ä¶ an umbrella. It‚Äôs definitely going to rain sunshine today.</p>
      <p>Each one unique, like sprinkles.</p>
      <p><b>Esu:</b> Example: The word <span class="note" data-note="Mochi is a Japanese rice cake made of glutinous rice.">mochi</span> refers to a Japanese rice cake.</p>
          <p>:: ‚åÇ Location ‚Ä¢ Seisoukan Apartments ::</p> 
      <p><b>Esu:</b> First day of spring! I brought mochi for everyone.</p>
      <p>And it‚Äôs strawberry flavored!</p>
      <p><b>Yuuta:</b> I brought‚Ä¶ an umbrella. It‚Äôs definitely going to rain sunshine today.</p>
      <p>Each one unique, like sprinkles.</p>
      <p><b>Hinata:</b> Bruh <span class="note" data-note="I'm a">lololol</span> abdd</p>
      </section id="script">

    <section id="figure"><figure><b><img src="Test_Cap.png" alt="testcap"></figure></section>

    <div class="controls">
      <button class="btn" id="btnPrev">‚ü®‚óÄ</button>
      <button class="btn" id="btnPage">‚ãÆ</button>
      <button class="btn" id="btnNext">‚ñ∂‚ü©</button>
    </div>

    <div class="tl-notes">
      <h2>TL Notes</h2>
      <p>Example: The word <span class="note" data-note="Mochi is a Japanese rice cake made of glutinous rice.">mochi</span> refers to a Japanese rice cake.</p>
    </div>
  </div>

  <button class="nav-btn nav-prev">‚ü®</button>
  <button class="nav-btn nav-next">‚ü©</button>
  <button class="nav-btn nav-page">‚ò∞</button>

  <script>
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function makeInitials(name){
      return name.split(/\s+/).map(w=>w[0]||"").join("").slice(0,2).toUpperCase();
    }

    (function buildDialogue(){
      const script = document.getElementById('script');
      if(!script) return;

      let avatarMap = {};
      try { avatarMap = JSON.parse(script.dataset.avatars || '{}'); }
      catch(e){ console.warn('Invalid data-avatars JSON'); }

      const raw = $$('#script > p');
      script.innerHTML = '';

      let sceneCount = 0;
      let lastAvatar = null;
      let lastName = null;

      raw.forEach(p => {
        const text = p.innerHTML.trim();

        if(/^::\s*.*\s*::$/.test(p.textContent.trim())){
          const label = p.textContent.replace(/^::\s*|\s*::$/g,'').trim();
          const scene = document.createElement('div');
          scene.className = 'scene';
          scene.id = 'scene-' + (++sceneCount);
          const div = document.createElement('div');
          div.className = 'divider';
          div.innerHTML = `<div class="rule"></div><div class="chip">${label}</div><div class="rule"></div>`;
          scene.appendChild(div);
          script.appendChild(scene);
          lastAvatar = null;
          lastName = null;
          return;
        }

        if(p.querySelector('figure')){
          const scene = script.lastElementChild || document.createElement('div');
          if(!scene.classList.contains('scene')){
            scene.className = 'scene';
            scene.id = 'scene-' + (++sceneCount);
            script.appendChild(scene);
          }
          scene.appendChild(p.querySelector('figure'));
          return;
        }

        const b = p.querySelector('b');
        if(b && /:\s*$/.test(b.textContent)){
          const name = b.textContent.replace(/:\s*$/,'').trim();
          const contentHTML = p.innerHTML.replace(p.querySelector('b').outerHTML,'').trim();

          let currentScene = script.lastElementChild;
          if(!currentScene || !currentScene.classList.contains('scene')){
            currentScene = document.createElement('div');
            currentScene.className = 'scene';
            currentScene.id = 'scene-' + (++sceneCount);
            script.appendChild(currentScene);
          }

          const line = document.createElement('div');
          line.className = 'line';

          const avatar = document.createElement('div');
          avatar.className = 'avatar';
          const url = avatarMap[name] || '';
          if(url){ avatar.style.backgroundImage = `url(${url})`; }
          else { avatar.classList.add('initials'); avatar.textContent = makeInitials(name); }

          const bubbleWrap = document.createElement('div');
          bubbleWrap.className = 'bubble-wrap';
          const nameEl = document.createElement('div');
          nameEl.className = 'bubble-name';
          nameEl.textContent = name;
          const bubble = document.createElement('div');
          bubble.className = 'bubble';
          bubble.innerHTML = contentHTML;

          bubbleWrap.appendChild(nameEl);
          bubbleWrap.appendChild(bubble);
          line.appendChild(avatar);
          line.appendChild(bubbleWrap);
          currentScene.appendChild(line);

          lastAvatar = avatar;
          lastName = name;
          return;
        }

        let currentScene = script.lastElementChild;
        if(!currentScene || !currentScene.classList.contains('scene')){
          currentScene = document.createElement('div');
          currentScene.className = 'scene';
          currentScene.id = 'scene-' + (++sceneCount);
          script.appendChild(currentScene);
        }
        if(lastAvatar && lastName){
          const line = document.createElement('div');
          line.className = 'line no-avatar';
          const spacer = document.createElement('div');
          spacer.style.width = '48px';
          const bubbleWrap = document.createElement('div');
          bubbleWrap.className = 'bubble-wrap';
          const bubble = document.createElement('div');
          bubble.className = 'bubble';
          bubble.innerHTML = p.innerHTML;
          bubbleWrap.appendChild(bubble);
          line.appendChild(spacer);
          line.appendChild(bubbleWrap);
          currentScene.appendChild(line);
        }
      });
    })();

    function currentSceneIndex(){
      const scenes = $$('#script .scene');
      const pos = window.scrollY + window.innerHeight * 0.35;
      let idx = 0;
      scenes.forEach((s,i)=>{ if(s.offsetTop <= pos) idx = i; });
      return idx;
    }

    function goTo(idx){
      const scenes = $$('#script .scene');
      if(!scenes.length) return;
      idx = Math.max(0, Math.min(idx, scenes.length-1));
      scenes[idx].scrollIntoView({behavior:'smooth', block:'start'});
    }

    $('.nav-prev').addEventListener('click', ()=>{ goTo(currentSceneIndex()-1); });
    $('.nav-next').addEventListener('click', ()=>{ goTo(currentSceneIndex()+1); });
    $('.nav-page').addEventListener('click', ()=>{ alert('Navigation page placeholder'); });
    $('#btnPrev').addEventListener('click', ()=>{ goTo(currentSceneIndex()-1); });
    $('#btnNext').addEventListener('click', ()=>{ goTo(currentSceneIndex()+1); });
    $('#btnPage').addEventListener('click', ()=>{ alert('Navigation page placeholder'); });

    window.addEventListener('keydown', (e)=>{
      if(['ArrowLeft','ArrowRight'].includes(e.key)){
        e.preventDefault();
        goTo(currentSceneIndex() + (e.key==='ArrowRight'? 1 : -1));
      }
    });
  </script>
</body>
</html>

