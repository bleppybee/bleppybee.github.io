<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsafe - Ch3</title>

  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <a class="home-btn" href="https://bleppybee.github.io/" title="Home">üêù</a>
  </header>

  <div class="hex-img-wrap">
    <div class="meta">
      <div class="release">Release Date: <em>Mar-30-2025</em></div>
      <h2>Story Title: <em>Unsafe</em></h2>
      <small>‚ÄúDo Not Mix; Potentially Dangerous‚Äù - Chapter 3</small>
      <div class="Translation By"><small>Translation By: Bee</small></div>
      <div class="characters">
        <b>Characters:</b>
         <img src="images/Heads/ES_Head_Ritsu.png" alt="Ritsu" >
         <img src="images/Heads/ES_Head_Niki.png" alt="Niki">
      </div>
    </div>

    <section id="script"
      data-avatars='{"Ritsu":"images/Icons/Ritsu1.png","Niki":"images/Icons/Niki1.png"}'>
      <p>:: ‚òÅ Season ‚Ä¢ ‚òÄÔ∏é Summer ‚Ä¢ 2nd Year of ES::</p>
      <p>:: ‚ñº Location ‚Ä¢ Seisoukan Apartments ‚Ä¢ Kitchen::</p>
<p><strong>Niki:&nbsp;</strong>Anyway, I don&rsquo;t really get all the complicated parts, but just like Ritsu-kun is saying, it has me completely stumped.</p>
<p>So I wondered if it was just a bad idea for someone who has no experience to make something so difficult.</p>
<p>Maybe origami is similar to cooking, in that you&rsquo;re required to master the basics first, before you can move ahead to the next steps.</p>
<p><strong>Ritsu:&nbsp;</strong>Ahaha, yeah, probably.</p>
<p>But judging from what you&rsquo;ve got in your hand, you&rsquo;re not even close to mastering the basics yet.</p>
      <blockquote><figure><img src="images/Unsafecaps/Ch3C1.png" /></figure></blockquote>
<p><strong>Ritsu:</strong> There are butchered crane(?) remains all over. Poor them&hellip;</p>
<p>This one doesn&rsquo;t even have a head or wings, how did you even manage that?</p>
<p><strong>Niki:</strong>&nbsp;Yeah, I don&rsquo;t really get how that happened either. Nahaha, it&rsquo;s so weird.</p>
<p><strong>Ritsu:</strong>&nbsp;Regardless, I get the reasons behind Nikipyon&rsquo;s strange behavior, now. But it was seriously confusing.</p>
<p>Even if you were struggling with origami, you still shouldn&rsquo;t have been saying ominous things while folding it.</p>
<p><strong>Niki:&nbsp;</strong>Ughh, I&rsquo;m sorry~</p>
<p><strong>Ritsu:</strong>&nbsp;Yep, it&rsquo;s good you&rsquo;re owning up to it.</p>
<p>So, what&rsquo;s your plan with the origami shop? You don&rsquo;t have much time before the bazaar, right?</p>
<p>Going by the way Nikipyon has been folding these cranes, the day will come before you get the chance to master it.&nbsp;</p>
<p>Children would be upset if you handed them tattered origami cranes, so why don&rsquo;t you just forfeit that origami stall idea?</p>
<p><strong>Niki:</strong>&nbsp;Hahh, to be honest, I clued in to the difficulty here around the time I ripped off that crane&rsquo;s wings.</p>
<p>But still, what other things would kids even like?</p>
<p>&ndash;Oh! That&rsquo;s right!&nbsp;</p>
<p>Ritsu-kun, you&rsquo;re the &lsquo;Military Strategist&rsquo; for &ldquo;Knights&rdquo;, aren&rsquo;t you?</p>
<p><strong>Ritsu:</strong>&nbsp;&ndash;Erm&hellip;</p>
<p><strong>Niki:&nbsp;</strong>A &lsquo;Military Strategist&rsquo; is a person a high ranking official employs to come up with an array of strategies, right?</p>
<p><strong>Ritsu:</strong>&nbsp;I mean, in a broad sense? That&rsquo;s&hellip;</p>
<p><strong>Niki:&nbsp;</strong>Ritsu-kun! Please be my strategist!</p>
<p><strong>Ritsu:</strong> Huh&hellip;?</p>
<p><strong>Niki:</strong> I want your idea for something kids will enjoy!</p>
<p><strong>Ritsu:</strong>&nbsp;Ugh, that&rsquo;s a hassle. Bye-bye, Nikipyon.</p>
<p><strong>Niki:</strong>&nbsp;W-wait, hold on a sec~!? This is my request of a lifetime!</p>
<p>In &ldquo;Crazy:B&rdquo;, it&rsquo;s Rinne-kun and HiMERU-kun who&rsquo;re the smart ones, and I always just follow along with what everybody else is doing~</p>
<p>And so, I&rsquo;m useless at coming up with ideas like this.</p>
<p><strong>Ritsu:</strong>&nbsp;Why not just sell sweets or something? Kids love sweets.</p>
<p><strong>Niki:</strong>&nbsp;Nah, the sweets idea is a no-go.</p>
<p><strong>Ritsu:</strong> Hah? You&rsquo;re the one who asked for a suggestion, don&rsquo;t be picky.</p>
<p><strong>Niki:&nbsp;</strong>I&rsquo;m not being picky, it&rsquo;s an actual rule~. If it were possible, I&rsquo;d choose to sell sweets.</p>
<p><strong>Ritsu:</strong>&nbsp;Eh~ nope. Why don&rsquo;t you do your own thinking, Nikipyon?</p>
<p><strong>Niki:&nbsp;</strong>Ugh&hellip; it seems like even Ritsu-kun&rsquo;s smarts aren&rsquo;t capable of solving a puzzle this difficult.</p>
<p><strong>Ritsu:</strong>&hellip;Huh?</p>
<p><strong>Niki:&nbsp;</strong>I always thought that smart people could just endlessly come up with solutions for things. I thought Ritsu-kun would be able to come up with one.&nbsp;</p>
<p>Hahh, that&rsquo;s disappointing&hellip;</p>
<p><strong>Ritsu:</strong>&nbsp;No, no. Don&rsquo;t misunderstand.</p>
<p>It&rsquo;s not like it&rsquo;s a strategist&rsquo;s job to be a walking encyclopaedia. Our role is to come up with the most optimal solutions, to solve dilemmas.&nbsp;</p>
<p>We <em>are</em> still smart, but not like the kind of person who just knows everything. I don&rsquo;t want you getting it twisted, okay?</p>
<p><strong>Niki:&nbsp;</strong>Hm? So &lsquo;military strategists&rsquo; aren&rsquo;t even that smart in the end, that&rsquo;s what you&rsquo;re saying?</p>
<p><strong>Ritsu:</strong>&nbsp;No, it&rsquo;s that our role isn&rsquo;t to provide &ldquo;knowledge&rdquo;, it&rsquo;s to apply &ldquo;wisdom&rdquo;.</p>
<p><strong>Niki:&nbsp;</strong>But you can&rsquo;t think up any ideas, is that really what a &lsquo;military strategist&rsquo; is?</p>
<p><strong>Ritsu:</strong>&nbsp;It&rsquo;s not like I&nbsp;<em>can&rsquo;t</em>. Once the knowledge has been given, the rest is pretty easy.</p>
<p><strong>Niki:&nbsp;</strong>So, you mean that you could come up with ideas for me if you tried to?</p>
<p><strong>Ritsu:</strong>&nbsp;Naturally. I wouldn&rsquo;t even need to try that hard.</p>
<p><strong>Niki:&nbsp;</strong>I&rsquo;m so happy! With the wise input of &ldquo;Knights&rsquo;&rdquo; strategist, this bazaar&rsquo;s gonna be a success for sure!</p>
      <blockquote><figure><img src="images/Unsafecaps/Ch3C2.png" /></figure></blockquote>
<p><strong>Ritsu:</strong> &mdash;Crap. Hold on a sec, Nikipyon. I didn&rsquo;t even say said I&rsquo;d thi&ndash;</p>
<p><strong>Niki:&nbsp;</strong>Nahaha~ maybe the real treasure was the wise military strategist <sup><span class="note" data-note="[1] Niki is doing something similar to how &lsquo;maybe the real treasure was the friends we made along the way&rsquo; gets the word &lsquo;friends&rsquo; swapped out for different things as a joke. In this case, it&rsquo;s &lsquo;ÊåÅ„Å§„Åπ„Åç„ÇÇ„ÅÆ„ÅØÂèã‰∫∫&rsquo;- (A friend is a good thing to have/what you need is a friend). Instead, he used &lsquo;wise military strategist&rsquo;."></sup>we made along the way</span></sup>, right~<strong>‚ô™</strong></p>
<p><strong>Ritsu: </strong>(&hellip;Wait? Why does it feel like I can&rsquo;t get out of this?)</p>
<p>(I only spoke up to avoid a troublesome situation, so how did it end up like this instead?)</p>
<p>(Maybe I never should have spoken up to Nikipyon the first place&hellip;?)</p>

      <p>:: End of Chapter 3 ::</p>
      </section id="script">

<!-- section id="figure"><img src="images/testcap.png" alt="testcap"></section> -->

    <div class="controls">
      <button class="btn" id="btnPrev">‚ü®‚óÄ</button>
      <button class="btn" id="btnPage">‚ãÆ</button>
      <button class="btn" id="btnNext">‚ñ∂‚ü©</button>
    </div>

    <div class="tl-notes">
      <h2>TL Notes</h2>
      <p>[1] Niki is doing something similar to how &lsquo;maybe the real treasure was the friends we made along the way&rsquo; gets the word &lsquo;friends&rsquo; swapped out for different things as a joke. In this case, it&rsquo;s &lsquo;ÊåÅ„Å§„Åπ„Åç„ÇÇ„ÅÆ„ÅØÂèã‰∫∫&rsquo;- (A friend is a good thing to have/what you need is a friend). Instead, he used &lsquo;wise military strategist&rsquo;.</p>
    </div>
  </div>

  <button class="nav-btn nav-prev">‚ü®</button>
  <button class="nav-btn nav-next">‚ü©</button>
  <button class="nav-btn nav-page">‚ò∞</button>

  <script>
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function makeInitials(name){
      return name.split(/\s+/).map(w=>w[0]||"").join("").slice(0,2).toUpperCase();
    }

   (function buildDialogue(){
  const script = document.getElementById('script');
  if(!script) return;

  let avatarMap = {};
  try { avatarMap = JSON.parse(script.dataset.avatars || '{}'); }
  catch(e){ console.warn('Invalid data-avatars JSON'); }

  // üëá iterate over ALL direct children (<p>, <blockquote>, <figure>, etc.)
  const raw = Array.from(script.children);
  script.innerHTML = '';

  let sceneCount = 0;
  let lastAvatar = null;
  let lastName = null;

  raw.forEach(el => {
    // --- SCENE DIVIDER (:: ... ::) ---
    if(/^::\s*.*\s*::$/.test(el.textContent.trim())){
      const label = el.textContent.replace(/^::\s*|\s*::$/g,'').trim();
      const scene = document.createElement('div');
      scene.className = 'scene';
      scene.id = 'scene-' + (++sceneCount);
      const div = document.createElement('div');
      div.className = 'divider';
      div.innerHTML = `<div class="rule"></div><div class="chip">${label}</div><div class="rule"></div>`;
      scene.appendChild(div);
      script.appendChild(scene);
      lastAvatar = null;
      lastName = null;
      return;
    }

    // --- BLOCKQUOTE (for figure panels or styled breaks) ---
    if (el.tagName.toLowerCase() === 'blockquote') {
      let currentScene = script.lastElementChild;
      if (!currentScene || !currentScene.classList.contains('scene')) {
        currentScene = document.createElement('div');
        currentScene.className = 'scene';
        currentScene.id = 'scene-' + (++sceneCount);
        script.appendChild(currentScene);
      }
      currentScene.appendChild(el); // just drop it in, CSS will style
      return;
    }

    // --- FIGURE (in case figure is a direct child, not wrapped in blockquote) ---
    if (el.tagName.toLowerCase() === 'figure') {
      let currentScene = script.lastElementChild;
      if (!currentScene || !currentScene.classList.contains('scene')) {
        currentScene = document.createElement('div');
        currentScene.className = 'scene';
        currentScene.id = 'scene-' + (++sceneCount);
        script.appendChild(currentScene);
      }
      const wrapper = document.createElement('blockquote');
      wrapper.appendChild(el);
      currentScene.appendChild(wrapper);
      return;
    }

    // --- DIALOGUE (strong NAME:) ---
    if(el.querySelector('strong') && /:\s*$/.test(el.querySelector('strong').textContent)){
      const name = el.querySelector('strong').textContent.replace(/:\s*$/,'').trim();
      const contentHTML = el.innerHTML.replace(el.querySelector('strong').outerHTML,'').trim();

      let currentScene = script.lastElementChild;
      if(!currentScene || !currentScene.classList.contains('scene')){
        currentScene = document.createElement('div');
        currentScene.className = 'scene';
        currentScene.id = 'scene-' + (++sceneCount);
        script.appendChild(currentScene);
      }

      const line = document.createElement('div');
      line.className = 'line';

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      const url = avatarMap[name] || '';
      if(url){ avatar.style.backgroundImage = `url(${url})`; }
      else { avatar.classList.add('initials'); avatar.textContent = makeInitials(name); }

      const bubbleWrap = document.createElement('div');
      bubbleWrap.className = 'bubble-wrap';
      const nameEl = document.createElement('div');
      nameEl.className = 'bubble-name';
      nameEl.textContent = name;
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.innerHTML = contentHTML;

      bubbleWrap.appendChild(nameEl);
      bubbleWrap.appendChild(bubble);
      line.appendChild(avatar);
      line.appendChild(bubbleWrap);
      currentScene.appendChild(line);

      lastAvatar = avatar;
      lastName = name;
      return;
    }

    // --- NARRATION (plain <p>) ---
    if(el.tagName.toLowerCase() === 'p'){
      let currentScene = script.lastElementChild;
      if(!currentScene || !currentScene.classList.contains('scene')){
        currentScene = document.createElement('div');
        currentScene.className = 'scene';
        currentScene.id = 'scene-' + (++sceneCount);
        script.appendChild(currentScene);
      }
      if(lastAvatar && lastName){
        const line = document.createElement('div');
        line.className = 'line no-avatar';
        const spacer = document.createElement('div');
        spacer.style.width = '48px';
        const bubbleWrap = document.createElement('div');
        bubbleWrap.className = 'bubble-wrap';
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.innerHTML = el.innerHTML;
        bubbleWrap.appendChild(bubble);
        line.appendChild(spacer);
        line.appendChild(bubbleWrap);
        currentScene.appendChild(line);
      }
      return;
    }
  });
})();

    function currentSceneIndex(){
      const scenes = $$('#script .scene');
      const pos = window.scrollY + window.innerHeight * 0.35;
      let idx = 0;
      scenes.forEach((s,i)=>{ if(s.offsetTop <= pos) idx = i; });
      return idx;
    }

    function goTo(idx){
      const scenes = $$('#script .scene');
      if(!scenes.length) return;
      idx = Math.max(0, Math.min(idx, scenes.length-1));
      scenes[idx].scrollIntoView({behavior:'smooth', block:'start'});
    }
    document.querySelectorAll('.note').forEach(el=>{
  el.addEventListener('mouseenter', e=>{
    const tip = document.createElement('div');
    tip.className = 'tooltip';
    tip.textContent = el.dataset.note;
    document.body.appendChild(tip);
    const rect = el.getBoundingClientRect();
    const tipRect = tip.getBoundingClientRect();

    // Default above
    let top = rect.top - tipRect.height - 8;
    let left = rect.left + rect.width/2 - tipRect.width/2;

    // If off-screen above, put below
    if(top < 0) top = rect.bottom + 8;

    // Clamp horizontally
    if(left < 8) left = 8;
    if(left + tipRect.width > window.innerWidth - 8)
      left = window.innerWidth - tipRect.width - 8;

    tip.style.position = 'absolute';
    tip.style.top = top + 'px';
    tip.style.left = left + 'px';

    el._tooltip = tip;
  });

  el.addEventListener('mouseleave', e=>{
    if(el._tooltip){ el._tooltip.remove(); el._tooltip=null; }
  });
});


    $('.nav-prev').addEventListener('click', ()=>{ goTo(currentSceneIndex()-1); });
    $('.nav-next').addEventListener('click', ()=>{ goTo(currentSceneIndex()+1); });
    $('.nav-page').addEventListener('click', ()=>{ location.href = "https://bleppybee.github.io/UnsafeNavi"; });
    $('#btnPrev').addEventListener('click', ()=>{ location.href = "https://bleppybee.github.io/Unsafe2"; });
    $('#btnNext').addEventListener('click', ()=>{ location.href =  "https://bleppybee.github.io/UnsafeNavi"; });

    $('#btnPage').addEventListener('click', ()=>{ location.href = "https://bleppybee.github.io/UnsafeNavi"; });

    window.addEventListener('keydown', (e)=>{
      if(['ArrowLeft','ArrowRight'].includes(e.key)){
        e.preventDefault();
        goTo(currentSceneIndex() + (e.key==='ArrowRight'? 1 : -1));
      }
    });

  </script>
</body>
</html>